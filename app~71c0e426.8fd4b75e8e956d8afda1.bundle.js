"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[884],{2817:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(467),i=n(3029),r=n(2901),o=n(4756),s=n.n(o),c=n(3843),l=function(){return(0,r.A)((function e(){(0,i.A)(this,e),this._presenter=new c.A(this)}),[{key:"render",value:(t=(0,a.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'\n      <section class="about container">\n        <h1>About Dicoding Story</h1>\n        \n        <div class="about-content">\n          <div class="about-image">\n            <img src="images/logo.png" alt="Dicoding Logo">\n          </div>\n          \n          <div class="about-text">\n            <p>\n              Dicoding Story is a platform for Dicoding students to share their learning journey, \n              projects, and experiences with the community.\n            </p>\n            \n            <p>\n              This application was built as a submission for the Dicoding Web Intermediate course, \n              demonstrating skills in Single Page Application development, API integration, \n              and modern web features.\n            </p>\n            \n            <h2>Features</h2>\n            <ul class="features-list">\n              <li><i class="fas fa-check-circle"></i> Share stories with photos</li>\n              <li><i class="fas fa-check-circle"></i> Add location to your stories</li>\n              <li><i class="fas fa-check-circle"></i> Explore stories on an interactive map</li>\n              <li><i class="fas fa-check-circle"></i> Receive push notifications</li>\n              <li><i class="fas fa-check-circle"></i> Works offline with service worker</li>\n            </ul>\n            \n            '.concat(this._presenter.isUserLoggedIn()?'\n              <div class="about-actions">\n                <a href="#/stories/add" class="button primary">\n                  <i class="fas fa-plus"></i> Share Your Story\n                </a>\n              </div>\n            ':"","\n          </div>\n        </div>\n      </section>\n    "));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"afterRender",value:(e=(0,a.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})}]);var e,t}()},4780:(e,t,n)=>{var a=n(467),i=n(4756),r=n.n(i),o=(n(3128),n(9997),n(9331),n(3029)),s=n(2901),c=n(6872),l=n(5077),d=n(1702),u=function(){return(0,s.A)((function e(t){var n=t.content,a=t.drawerButton,i=t.navigationDrawer;(0,o.A)(this,e),this._content=n,this._drawerButton=a,this._navigationDrawer=i,this._setupDrawer(),this._checkAuth()}),[{key:"_setupDrawer",value:function(){var e=this;this._drawerButton.addEventListener("click",(function(){e._navigationDrawer.classList.toggle("open")})),document.body.addEventListener("click",(function(t){e._navigationDrawer.contains(t.target)||e._drawerButton.contains(t.target)||e._navigationDrawer.classList.remove("open")})),this._navigationDrawer.querySelectorAll("a").forEach((function(t){t.addEventListener("click",(function(){e._navigationDrawer.classList.remove("open")}))}))}},{key:"_checkAuth",value:function(){var e=d.A.getUserToken(),t=window.location.hash.split("?")[0];e||["#/login","#/register","#/about"].includes(t)?!e||"#/login"!==t&&"#/register"!==t||(window.location.hash="#/"):window.location.hash="#/login"}},{key:"renderPage",value:(e=(0,a.A)(r().mark((function e(){var t,n,i=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,l.EW)(),n=c.A[t]){e.next=5;break}return this._content.innerHTML='\n        <section class="container">\n          <div class="error">\n            <i class="fas fa-exclamation-triangle"></i>\n            <h2>404 - Halaman Tidak Ditemukan</h2>\n            <p>Halaman yang Anda cari tidak ada.</p>\n            <a href="#/" class="button primary">Kembali ke Beranda</a>\n          </div>\n        </section>\n      ',e.abrupt("return");case 5:if(e.prev=5,!document.startViewTransition){e.next=10;break}document.startViewTransition((0,a.A)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.render();case 2:return i._content.innerHTML=e.sent,e.next=5,n.afterRender();case 5:i._updateActiveNavLink(),i._checkAuth();case 7:case"end":return e.stop()}}),e)})))),e.next=17;break;case 10:return e.next=12,n.render();case 12:return this._content.innerHTML=e.sent,e.next=15,n.afterRender();case 15:this._updateActiveNavLink(),this._checkAuth();case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),this._content.innerHTML='\n        <section class="container">\n          <div class="error">\n            <i class="fas fa-exclamation-triangle"></i>\n            <h2>Error Memuat Halaman</h2>\n            <p>'.concat(e.t0.message||"Silakan coba lagi nanti",'</p>\n            <a href="#/" class="button primary">Kembali ke Beranda</a>\n          </div>\n        </section>\n      ');case 23:case"end":return e.stop()}}),e,this,[[5,19]])}))),function(){return e.apply(this,arguments)})},{key:"_updateActiveNavLink",value:function(){var e=document.querySelectorAll(".nav-list a"),t=window.location.hash.split("?")[0];e.forEach((function(e){var n=e.getAttribute("href").split("?")[0];n===t||"#/"===n&&""===t?e.classList.add("active"):e.classList.remove("active")}))}}]);var e}();document.addEventListener("DOMContentLoaded",(0,a.A)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.getItem("token")||window.location.hash.includes("#/login")||window.location.hash.includes("#/register")||(window.location.hash="#/login"),n=new u({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),e.next=5,n.renderPage();case 5:(function(){var e=document.getElementById("drawer-button"),t=document.getElementById("navigation-drawer"),n=document.getElementById("nav-overlay");if(e&&t&&n){var a=function(a){var i=null!=a?a:"true"!==e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",i),t.classList.toggle("open",i),n.classList.toggle("active",i),i?document.body.classList.add("menu-open"):document.body.classList.remove("menu-open")};a(!1),e.addEventListener("click",(function(e){e.stopPropagation(),a()})),n.addEventListener("click",(function(){return a(!1)})),t.querySelectorAll("a").forEach((function(e){e.addEventListener("click",(function(){return a(!1)}))})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&"true"===e.getAttribute("aria-expanded")&&a(!1)}));var i=function(){window.innerWidth>999?(a(!1),e.style.display="none"):e.style.display="block"};i(),window.addEventListener("resize",i)}})(),null===(t=document.querySelector(".skip-link"))||void 0===t||t.addEventListener("click",(function(e){e.preventDefault(),document.getElementById("main-content").focus()})),window.addEventListener("hashchange",(0,a.A)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.renderPage();case 2:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e)}))))},6665:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(467),i=n(3029),r=n(2901),o=n(4756),s=n.n(o),c=n(965),l=n(344),d=n(1702),u=n(6559),p=function(){return(0,r.A)((function e(){(0,i.A)(this,e),this._photoFile=null,this._map=null,this._marker=null,this._lat=null,this._lon=null,this._cameraStream=null,this._isLoading=!1}),[{key:"render",value:(o=(0,a.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.A.isUserLoggedIn()){e.next=2;break}return e.abrupt("return",'\n        <section class="container">\n          <div class="auth-required">\n            <h2>üîê Login Required</h2>\n            <p>Please login to share your story</p>\n            <div class="auth-buttons">\n              <a href="#/login" class="button primary">Login</a>\n              <a href="#/register" class="button secondary">Register</a>\n            </div>\n          </div>\n        </section>\n      ');case 2:return e.abrupt("return",'\n      <section class="add-story">\n        <div class="container">\n          <div class="add-story-header">\n            <h1><i class="fas fa-plus-circle"></i> Share Your Story</h1>\n            <p class="subtitle">Capture your learning journey moments</p>\n          </div>\n\n          <form id="story-form" class="story-form">\n            <div class="form-group">\n              <label for="description"><i class="fas fa-align-left"></i> Story Description</label>\n              <textarea \n                id="description" \n                name="description" \n                required\n                placeholder="Tell us about your experience..."\n                class="form-control"\n              ></textarea>\n            </div>\n\n            <div class="form-group">\n              <label><i class="fas fa-camera"></i> Add Photo</label>\n              <div class="photo-upload-container">\n                <div class="upload-options">\n                  <button type="button" id="from-storage" class="button secondary">\n                    <i class="fas fa-folder-open"></i> Choose File\n                  </button>\n                  \n                  <button type="button" id="from-camera" class="button secondary">\n                    <i class="fas fa-camera"></i> Take Photo\n                  </button>\n                </div>\n                \n                <div class="upload-preview">\n                  <div id="photo-status">\n                    <span id="photo-name">No file selected</span>\n                    <span id="photo-size" class="file-size"></span>\n                  </div>\n                  <div id="photo-preview" class="preview-image"></div>\n                  <button type="button" id="remove-photo" class="button danger small">\n                    <i class="fas fa-trash"></i> Remove\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            <div class="form-group">\n              <label><i class="fas fa-map-marker-alt"></i> Add Location (Optional)</label>\n              <div class="location-controls">\n                <button type="button" id="select-location" class="button small">\n                  <i class="fas fa-map"></i> Select on Map\n                </button>\n                <span id="location-status">No location selected</span>\n              </div>\n              <div id="map-container" class="map-preview"></div>\n            </div>\n\n            <div class="form-actions">\n              <button type="submit" class="button primary" id="submit-button">\n                <i class="fas fa-paper-plane"></i> Publish Story\n              </button>\n            </div>\n          </form>\n\n          <div id="error-message" class="error-message" hidden></div>\n        </div>\n      </section>\n\n      \x3c!-- Camera Modal --\x3e\n      <div id="camera-modal" class="modal camera-modal" hidden>\n        <div class="modal-content">\n          <div class="modal-header">\n            <h3>Take Photo</h3>\n            <button id="close-camera" class="modal-close">&times;</button>\n          </div>\n          <div class="modal-body">\n            <video id="camera-view" autoplay playsinline></video>\n            <button id="capture-btn" class="button primary">\n              <i class="fas fa-camera"></i> Capture\n            </button>\n          </div>\n        </div>\n      </div>\n    ');case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(t=(0,a.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.A.isUserLoggedIn()){e.next=2;break}return e.abrupt("return");case 2:this._setupPhotoUpload(),this._setupLocation(),this._setupFormSubmit(),this._setupCamera();case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_setupPhotoUpload",value:function(){var e=this,t=document.getElementById("from-storage"),n=document.getElementById("from-camera"),a=document.createElement("input");a.type="file",a.accept="image/*",a.hidden=!0,document.body.appendChild(a);var i=document.getElementById("photo-name"),r=document.getElementById("photo-size"),o=document.getElementById("photo-preview"),s=document.getElementById("remove-photo");t.addEventListener("click",(function(){return a.click()})),n.addEventListener("click",(function(){return e._openCameraModal()})),a.addEventListener("change",(function(t){var n=t.target.files[0];n&&e._handleSelectedFile(n)})),s.addEventListener("click",(function(){e._photoFile=null,a.value="",i.textContent="No file selected",r.textContent="",o.innerHTML="",s.style.display="none"}))}},{key:"_openCameraModal",value:function(){var e=this,t=document.getElementById("camera-modal");t.hidden=!1,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}).then((function(t){e._cameraStream=t,document.getElementById("camera-view").srcObject=t})).catch((function(n){e._showError("Cannot access camera. Please ensure permissions are granted."),t.hidden=!0}))}},{key:"_handleSelectedFile",value:function(e){var t=document.getElementById("photo-name"),n=document.getElementById("photo-size"),a=document.getElementById("photo-preview"),i=document.getElementById("remove-photo"),r=document.getElementById("error-message");if(e)if(e.type.match("image.*"))if(e.size>u.A.MAX_FILE_SIZE)this._showError("File size too large (max ".concat(u.A.MAX_FILE_SIZE/1024/1024,"MB)"));else{this._photoFile=e,t.textContent=e.name,n.textContent="(".concat((e.size/1024).toFixed(2)," KB)"),i.style.display="block",r.hidden=!0;var o=new FileReader;o.onload=function(e){a.innerHTML='\n        <img src="'.concat(e.target.result,'" alt="Preview" class="preview-img">\n      ')},o.readAsDataURL(e)}else this._showError("File must be an image (JPEG, PNG, etc)")}},{key:"_setupCamera",value:function(){var e=this,t=document.getElementById("camera-modal"),n=document.getElementById("capture-btn"),a=document.getElementById("close-camera");n.addEventListener("click",(function(){var n=document.getElementById("camera-view"),a=document.createElement("canvas");a.width=n.videoWidth,a.height=n.videoHeight,a.getContext("2d").drawImage(n,0,0,a.width,a.height),a.toBlob((function(n){var a=new File([n],"camera-photo.jpg",{type:"image/jpeg",lastModified:Date.now()});e._handleSelectedFile(a),e._stopCamera(),t.hidden=!0}),"image/jpeg",.9)})),a.addEventListener("click",(function(){e._stopCamera(),t.hidden=!0}))}},{key:"_stopCamera",value:function(){if(this._cameraStream){this._cameraStream.getTracks().forEach((function(e){return e.stop()})),this._cameraStream=null;var e=document.getElementById("camera-view");e&&(e.srcObject=null)}}},{key:"_setupLocation",value:function(){var e=this,t=document.getElementById("select-location"),n=document.getElementById("location-status");document.getElementById("map-container");t.addEventListener("click",(0,a.A)(s().mark((function a(){return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e._isLoading){a.next=2;break}return a.abrupt("return");case 2:return e._isLoading=!0,t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin"></i> Loading Map...',a.prev=5,a.next=8,e._initMap();case 8:n.textContent="Click on the map to select location",a.next=16;break;case 11:a.prev=11,a.t0=a.catch(5),e._showError("Failed to load map. Please try again."),n.textContent="Map load failed";case 16:return a.prev=16,t.disabled=!1,t.innerHTML='<i class="fas fa-map"></i> Select on Map',e._isLoading=!1,a.finish(16);case 21:case"end":return a.stop()}}),a,null,[[5,11,16,21]])}))))}},{key:"_initMap",value:(e=(0,a.A)(s().mark((function e(){var t,a,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.resolve().then(n.t.bind(n,3481,23));case 3:t=e.sent,this._map&&this._map.remove(),a=this._lat&&this._lon?[this._lat,this._lon]:[-2.5489,118.0149],this._map=t.map("map-container").setView(a,5),t.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),this._marker&&this._map.removeLayer(this._marker),this._map.on("click",(function(e){i._lat=e.latlng.lat,i._lon=e.latlng.lng,i._marker&&i._map.removeLayer(i._marker);var n=t.divIcon({className:"custom-marker",html:'\n            <div class="marker-pin"></div>\n            <div class="marker-dot"></div>\n          ',iconSize:[30,42],iconAnchor:[15,42]});i._marker=t.marker([i._lat,i._lon],{icon:n}).addTo(i._map).bindPopup("Selected story location").openPopup(),document.getElementById("location-status").textContent="Location: ".concat(i._lat.toFixed(4),", ").concat(i._lon.toFixed(4))})),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(){return e.apply(this,arguments)})},{key:"_setupFormSubmit",value:function(){var e=this,t=document.getElementById("story-form"),n=document.getElementById("submit-button");t.addEventListener("submit",function(){var t=(0,a.A)(s().mark((function t(a){var i,r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),!e._isLoading){t.next=3;break}return t.abrupt("return");case 3:if(i=document.getElementById("description").value.trim()){t.next=7;break}return e._showError("Please enter story description"),t.abrupt("return");case 7:if(e._photoFile){t.next=10;break}return e._showError("Please add a photo"),t.abrupt("return");case 10:return e._isLoading=!0,n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin"></i> Publishing...',t.prev=13,(r=new FormData).append("description",i),r.append("photo",e._photoFile),e._lat&&e._lon&&(r.append("lat",e._lat),r.append("lon",e._lon)),t.next=20,c.A.addNewStory({description:i,photo:e._photoFile,lat:e._lat,lon:e._lon});case 20:if(!(o=t.sent).error){t.next=23;break}throw new Error(o.message);case 23:l.A.showNotification("Story Published",{body:'Your story "'.concat(i.substring(0,30),'..." has been published')}),window.location.hash="#/stories",t.next=31;break;case 27:t.prev=27,t.t0=t.catch(13),e._showError("Failed to publish story: ".concat(t.t0.message));case 31:return t.prev=31,n.disabled=!1,n.innerHTML='<i class="fas fa-paper-plane"></i> Publish Story',e._isLoading=!1,t.finish(31);case 36:case"end":return t.stop()}}),t,null,[[13,27,31,36]])})));return function(e){return t.apply(this,arguments)}}())}},{key:"_showError",value:function(e){var t=document.getElementById("error-message");t.innerHTML='\n      <i class="fas fa-exclamation-circle"></i> '.concat(e,"\n    "),t.hidden=!1,setTimeout((function(){t.hidden=!0}),5e3)}}]);var e,t,o}()}}]);
//# sourceMappingURL=app~71c0e426.8fd4b75e8e956d8afda1.bundle.js.map
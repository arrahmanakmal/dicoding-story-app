"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[379],{344:(e,r,t)=>{t.d(r,{A:()=>h});var n=t(4467),a=t(467),i=t(3029),s=t(2901),o=t(4756),c=t.n(o),u=t(6559),p=t(2922),v=t(1702);function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}const h=function(){return(0,s.A)((function e(){(0,i.A)(this,e)}),null,[{key:"requestPermission",value:(t=(0,a.A)(c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Notification"in window){e.next=3;break}return e.abrupt("return",!1);case 3:if("granted"!==Notification.permission){e.next=5;break}return e.abrupt("return",!0);case 5:return e.next=7,Notification.requestPermission();case 7:return r=e.sent,e.abrupt("return","granted"===r);case 9:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"subscribe",value:(r=(0,a.A)(c().mark((function e(){var r,t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("serviceWorker"in navigator){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,this.requestPermission();case 5:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.prev=9,e.next=12,navigator.serviceWorker.ready;case 12:return r=e.sent,e.next=15,r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array(u.A.VAPID_PUBLIC_KEY)});case 15:if(t=e.sent,!(n=v.A.getUserToken())){e.next=21;break}return e.next=20,p.A.subscribePushNotification({token:n,subscription:t});case 20:return e.abrupt("return",!0);case 21:return e.abrupt("return",!1);case 24:return e.prev=24,e.t0=e.catch(9),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,this,[[9,24]])}))),function(){return r.apply(this,arguments)})},{key:"unsubscribe",value:(e=(0,a.A)(c().mark((function e(){var r,t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("serviceWorker"in navigator){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.serviceWorker.ready;case 6:return r=e.sent,e.next=9,r.pushManager.getSubscription();case 9:if(!(t=e.sent)){e.next=18;break}if(!(n=v.A.getUserToken())){e.next=15;break}return e.next=15,p.A.unsubscribePushNotification({token:n,endpoint:t.endpoint});case 15:return e.next=17,t.unsubscribe();case 17:return e.abrupt("return",!0);case 18:return e.abrupt("return",!1);case 21:return e.prev=21,e.t0=e.catch(3),e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e,null,[[3,21]])}))),function(){return e.apply(this,arguments)})},{key:"showNotification",value:function(e,r){if("Notification"in window&&"granted"===Notification.permission){var t=new Notification(e,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({icon:"icons/icon-192x192.png",badge:"icons/icon-192x192.png"},r));t.onclick=function(e){e.preventDefault(),window.focus(),window.location.href="./"}}}},{key:"_urlBase64ToUint8Array",value:function(e){for(var r=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(r),n=new Uint8Array(t.length),a=0;a<t.length;++a)n[a]=t.charCodeAt(a);return n}}]);var e,r,t}()},3760:(e,r,t)=>{t.d(r,{A:()=>p});var n=t(467),a=t(3029),i=t(2901),s=t(4756),o=t.n(s),c=t(1702),u=t(344),p=function(){return(0,i.A)((function e(r){(0,a.A)(this,e),this._view=r}),[{key:"isUserLoggedIn",value:function(){return c.A.isUserLoggedIn()}},{key:"login",value:(r=(0,n.A)(o().mark((function e(r){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.email,n=r.password,e.prev=1,e.next=4,c.A.login({email:t,password:n});case 4:return e.next=6,u.A.subscribe();case 6:this._view.redirectToHome(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this._view.showError(e.t0.message);case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return r.apply(this,arguments)})},{key:"register",value:(e=(0,n.A)(o().mark((function e(r){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.name,n=r.email,a=r.password,e.prev=1,e.next=4,c.A.register({name:t,email:n,password:a});case 4:this._view.showSuccessAndRedirect(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this._view.showError(e.t0.message);case 10:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(r){return e.apply(this,arguments)})}]);var e,r}()},3843:(e,r,t)=>{t.d(r,{A:()=>s});var n=t(3029),a=t(2901),i=t(1702),s=function(){return(0,a.A)((function e(r){(0,n.A)(this,e),this._view=r}),[{key:"isUserLoggedIn",value:function(){return i.A.isUserLoggedIn()}}])}()},4481:(e,r,t)=>{t.d(r,{A:()=>f});var n=t(467),a=t(3029),i=t(2901),s=t(4756),o=t.n(s),c=t(965),u=t(4467);function p(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function v(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return"No date available";try{var n=new Date(e);return isNaN(n.getTime())?"Invalid date":n.toLocaleDateString(r,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?p(Object(t),!0).forEach((function(r){(0,u.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({year:"numeric",month:"long",day:"numeric"},t))}catch(e){return"Invalid date"}}var f=function(){return(0,i.A)((function e(r){(0,a.A)(this,e),this._view=r,this._repository=c.A}),[{key:"getAllStories",value:(t=(0,n.A)(o().mark((function e(r){var t,n,a,i,s,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.page,n=void 0===t?1:t,a=r.size,i=void 0===a?10:a,s=r.location,c=void 0===s?0:s,e.prev=1,e.next=4,this._repository.getAllStories({page:n,size:i,location:c});case 4:u=e.sent,this._view.showStories(u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this._view.showError(e.t0.message);case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return t.apply(this,arguments)})},{key:"getStoryDetail",value:(r=(0,n.A)(o().mark((function e(r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._repository.getStoryDetail(r);case 3:return t=e.sent,e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(0),this._view.showError(e.t0.message),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return r.apply(this,arguments)})},{key:"addNewStory",value:(e=(0,n.A)(o().mark((function e(r){var t,n,a,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.description,n=r.photo,a=r.lat,i=r.lon,e.prev=1,e.next=4,this._repository.addNewStory({description:t,photo:n,lat:a,lon:i});case 4:return s=e.sent,this._view.showSuccess(s.message),e.abrupt("return",s);case 9:throw e.prev=9,e.t0=e.catch(1),this._view.showError(e.t0.message),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(r){return e.apply(this,arguments)})},{key:"formatDate",value:function(e){return v(e)}}]);var e,r,t}()},5077:(e,r,t)=>{function n(e){var r=e.split("?")[0].split("/").filter((function(e){return""!==e}));return{resource:r[0]||null,id:r[1]||null,verb:r[2]||null}}function a(e){var r="";if(e.resource){if(r="/".concat(e.resource),"add"===e.id)return"".concat(r,"/add");e.id&&(r+="/:id",e.verb&&(r+="/".concat(e.verb)))}return r||"/"}function i(){return location.hash.replace("#","")||"/"}function s(){var e=i();return"/stories/add"===e?"/stories/add":a(n(e))}t.d(r,{EW:()=>s})},6166:(e,r,t)=>{t.d(r,{A:()=>u});var n=t(467),a=t(3029),i=t(2901),s=t(4756),o=t.n(s),c=t(2024),u=function(){return(0,i.A)((function e(r){(0,a.A)(this,e),this._view=r,this._database=c.A}),[{key:"getAllBookmarks",value:(t=(0,n.A)(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._database.getAllBookmarks();case 3:r=e.sent,this._view.showBookmarks(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this._view.showError(e.t0.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return t.apply(this,arguments)})},{key:"toggleBookmark",value:(r=(0,n.A)(o().mark((function e(r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._database.isBookmarked(r.id);case 3:if(!(t=e.sent)){e.next=10;break}return e.next=7,this._database.removeBookmark(r.id);case 7:this._view.showBookmarkRemoved(r),e.next=13;break;case 10:return e.next=12,this._database.addBookmark(r);case 12:this._view.showBookmarkAdded(r);case 13:return e.abrupt("return",!t);case 16:throw e.prev=16,e.t0=e.catch(0),this._view.showError(e.t0.message),e.t0;case 20:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e){return r.apply(this,arguments)})},{key:"isBookmarked",value:(e=(0,n.A)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._database.isBookmarked(r));case 1:case"end":return e.stop()}}),e,this)}))),function(r){return e.apply(this,arguments)})}]);var e,r,t}()},6872:(e,r,t)=>{t.d(r,{A:()=>f});var n=t(4241),a=t(2817),i=t(8209),s=t(7561),o=t(6665),c=t(4697),u=t(8614),p=t(6042),v=t(5165);const f={"/":new n.A,"/home":new n.A,"/about":new a.A,"/stories":new i.A,"/stories/:id":new s.A,"/stories/add":new o.A,"/map":new c.A,"/login":new u.A,"/register":new p.A,"/bookmarks":new v.A}},8577:(e,r,t)=>{t.d(r,{A:()=>s});var n=t(3029),a=t(2901),i=t(1702),s=function(){return(0,a.A)((function e(r){(0,n.A)(this,e),this._view=r}),[{key:"isUserLoggedIn",value:function(){return i.A.isUserLoggedIn()}},{key:"getUserName",value:function(){return i.A.getUserName()}},{key:"logout",value:function(){i.A.logout()}}])}()}}]);
//# sourceMappingURL=app~b6ab853d.8c918e9babf358fa8a5f.bundle.js.map